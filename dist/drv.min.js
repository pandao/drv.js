/*! Drv.js v0.1.1 | drv.min.js | The Combined Type JavaScript MVVM / MVC / SPA Development Framework, Based on Director.js, Require.js and Vue.js. | MIT License | By: Pandao | https://github.com/pandao/drv.js | 2015-07-22 */
!function(t){"use strict";"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&(define.amd||define.cmd)?window.Drv=t():window.Drv=t()}(function(){function t(t,e){for(var r in e)e[r]&&e[r].constructor&&e[r].constructor===Object?(t[r]=t[r]||{},arguments.callee(t[r],e[r])):t[r]=e[r];return t}function e(t,e,r,n){n=n||!1,t.eventHandler=r,t.attachEvent?t.attachEvent("on"+e,function(t){return n&&(t.cancelBubble=!0),!1===r(t)?!1:void 0}):t.addEventListener?t.addEventListener(e,function(t){n&&(t.cancelBubble=!0),!1===r(t)&&(t&&t.preventDefault?t.preventDefault():t.returnValue=!1)},n):t["on"+e]=r}function r(t,e,r,n){n=n||!1,t.detachEvent?t.detachEvent("on"+e,t.eventHandler):t.removeEventListener?t.removeEventListener(e,t.eventHandler,n):(t.eventHandler=null,t["on"+e]=null),r.call(t)}function n(t){return u=u?u:n.prototype.init(t)}function i(e,r,n){this.http=c.http=r.prototype.$http=n,this.http.constructor=function(){},this.viewModel=r;var i={},o=this.settings,u=o.routes;if(!o.directorConfigs.resource)for(var s in u)"string"==typeof u[s]&&(u[s]=this.controller(u[s])),i[s]=u[s];this.router=Router(u);var f={resource:i,html5history:o.useHistory,on:a["route.on"],before:a["route.before"],after:a["route.after"],notfound:this.notFound};f=t(f,o.directorConfigs),this.router.configure(f).init(o.routeInit),this.trigger("run.after")}function o(){if("undefined"!=typeof document){var t=document.querySelector("["+c.mainAttr+"]");t&&require([t.getAttribute(c.mainAttr)],function(){s=!0})}}var u=null,s=!1,c={};c.name="Drv.js",c.version="0.1.1",c.homePage="https://github.com/pandao/drv.js",c.description="The Combined Type JavaScript MVVM / MVC / SPA Development Framework, Based on Director.js, Require.js and Vue.js.",c.http=null,c.usingSingleton=!1,c.getApp=function(){return this.usingSingleton=!0,u};var a={"run.before":function(){},"run.after":function(){},"route.on":function(){},"route.before":function(){},"route.after":function(){},"render.before":function(){},"render.after":function(){},"action.before":function(){},"action.after":function(){},"require.error":function(t){console.error("Drv.js Require Error: ",t)}},f="bower_components/",h={path:"./",cssPath:"css/",viewPath:"views/",libPath:"lib/",imagesPath:"images/",routeInit:"/",viewSuffix:".html",useHistory:!1,bowerPath:f,controllerPath:"controllers/",directorConfigs:{},requireConfigs:{urlArgs:"",waitSeconds:60,baseUrl:"./",paths:{vue:f+"vue/dist/vue.min",hammerjs:f+"hammerjs/hammer.min",text:f+"requirejs-text/text",css:f+"require-css/css",httpx:f+"httpx.js/dist/httpx.min",jquery:f+"jquery/dist/jquery.min",vuetouch:f+"vue-touch/vue-touch",vuevalidator:f+"vue-validator/dist/vue-validator",underscore:f+"underscore/underscore-min",tiletemplate:f+"tiletemplate/dist/tiletemplate.min",director:f+"director/build/director.min"}},routes:{"/":function(){console.log("Hello Drv.js!")}}};return c.hooks=Object.create(a),c.defaults=Object.create(h),n.prototype={init:function(r){r=r||{},this.settings=t(h,r);var n=this;return e(window,"error",function(t){t.message.indexOf("requirejs")>-1&&n.trigger("require.error",t)}),require.config(this.settings.requireConfigs),this},controller:function(t){var e=this,r=this.settings;return function(){e.trigger("action.before",this),this.$ctl=t,this.$controller=t.split("/")[0],this.$action=t.split("/")[1],this.$params=arguments;var n=r.path+r.controllerPath+t+".js";require.undef(n),require([n],function(){e.trigger("route.after"),e.trigger("action.after")})}},http:{},viewModel:{},router:{},on:function(t,e){a[t]=e},off:function(t){a[t]=null,delete a[t]},trigger:function(t){if(a.hasOwnProperty(t)){if("function"!=typeof a[t])throw new TypeError("Hook "+t+" is not callable");a[t].bind(this)(arguments)}},extend:function(e){if("object"!=typeof e)throw new TypeError("extend(ext) param must be Object tpye.");t(this,e)},addEvent:e,removeEvent:r,notFound:function(){return console.error("HTTP 404 Not Found.",this),!1},requireFile:function(t,e){e=e||function(){};var r=this.settings,n=r.path+r.viewPath+t+r.viewSuffix;require(["text!"+n],function(r){e(r,n,t)})},requireCSS:function(t,e){e=e||function(){};var r=this.settings,n=r.path+r.cssPath+t;require(["css!"+n],function(){e(n)})},render:function(t,e){this.trigger("render.before");var r=this,n=r.settings,i="text!"+n.path+n.viewPath+t+n.viewSuffix;require([i],function(t){e.template=t,r.$vm=new r.viewModel(e),r.trigger("render.after")})}},n.prototype.run=function(e){return this.trigger("run.before"),e=t(this.settings.routes,e||{}),this.$data={},this.settings.routes=e,require(["director","vue","httpx"],i.bind(this)),this},n.prototype.constructor=n,c.App=n,c.mainAttr="drv-main",o(),c});